(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ae7bc38"],{"32f5":function(e,t,i){},4518:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"roleListTable"},[i("div",[i("el-button",{directives:[{name:"roleBtn",rawName:"v-roleBtn",value:"btn_100002",expression:"'btn_100002'"}],attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini",plain:""},on:{click:e.addRole}},[e._v("新增")])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[i("el-table-column",{attrs:{type:"index"}}),i("el-table-column",{attrs:{prop:"name",label:"角色名"}}),i("el-table-column",{attrs:{prop:"describe",label:"角色描述"}}),i("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:"启用"===t.row.status?"primary":"danger","disable-transitions":""}},[e._v(e._s(t.row.status)+" ")])]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",disabled:"超级管理员"==t.row.name},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑 ")]),i("el-button",{attrs:{size:"mini",type:"success",disabled:"超级管理员"==t.row.name},on:{click:function(i){return e.roleEdit(t.$index,t.row)}}},[e._v("权限分配 ")]),i("el-button",{attrs:{size:"mini",type:"danger",disabled:"超级管理员"==t.row.name},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[e._v("删除 ")])]}}])})],1),i("el-dialog",{staticClass:"dialog1",attrs:{title:"角色信息",width:"700px",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{model:e.form}},[i("el-form-item",{attrs:{label:"角色名称","label-width":e.formLabelWidth}},[i("el-input",{attrs:{maxlength:"8","show-word-limit":"",autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"角色描述","label-width":e.formLabelWidth}},[i("el-input",{attrs:{maxlength:"15","show-word-limit":"",autocomplete:"off"},model:{value:e.form.describe,callback:function(t){e.$set(e.form,"describe",t)},expression:"form.describe"}})],1),i("el-form-item",{attrs:{label:"是否开启","label-width":e.formLabelWidth}},[i("el-switch",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.addRoleSubmit}},[e._v("确 定")])],1)],1),i("el-dialog",{staticClass:"dialog2",attrs:{title:"权限分配",visible:e.dialogFormVisible2},on:{"update:visible":function(t){e.dialogFormVisible2=t},opened:e.setRoleData}},[i("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),i("el-tree",{ref:"permission",attrs:{data:e.roleTree,"node-key":"r_id","show-checkbox":"","check-on-click-node":"","default-expand-all":"","check-strictly":"","expand-on-click-node":!1,"filter-node-method":e.filterNode,props:e.defaultProps}}),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible2=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.rolePermissionSubmit}},[e._v("确 定")])],1)],1)],1)},s=[],a=(i("4de4"),i("b0c0"),i("ac1f"),i("1276"),i("1779")),l={name:"RoleManage",data:function(){return{tableData:[],dialogFormVisible:!1,dialogFormVisible2:!1,form:{name:"",describe:"",id:"",status:!0},formLabelWidth:"120px",defaultProps:{children:"children",label:"name"},selectRoleId:"",filterText:""}},computed:{roleTree:function(){var e=this.$store.getters.roleTree;return e}},watch:{filterText:function(e){this.$refs.permission.filter(e)}},mounted:function(){this.getList()},methods:{handleEdit:function(e,t){this.form.name=t.name,this.form.describe=t.describe,this.form.status="启用"===t.status,this.form.id=t.id,this.dialogFormVisible=!0},addRole:function(){this.form={name:"",describe:"",status:!0},this.dialogFormVisible=!0},addRoleSubmit:function(){var e=this;if(!this.form.name)return this.$message({showClose:!0,message:"角色名称不能为空",type:"error"}),!1;Object(a["a"])(this.form).then((function(t){t&&e.$message({type:"success",message:t.message}),e.dialogFormVisible=!1,e.getList()})).catch((function(t){e.$throw(t)}))},rolePermissionSubmit:function(){var e=this,t={selectPermission:this.$refs.permission.getCheckedKeys(),id:this.selectRoleId};Object(a["d"])(t).then((function(t){t?(e.$message({type:"success",message:t.message}),e.dialogFormVisible2=!1,e.getList(),location.reload()):e.dialogFormVisible2=!1})).catch((function(t){e.$throw(t)}))},roleEdit:function(e,t){this.selectRoleId=t.id,this.dialogFormVisible2=!0},setRoleData:function(){var e=this;Object(a["e"])({id:this.selectRoleId}).then((function(t){var i=t.data.permissionPage+","+t.data.permissionButton;e.$refs.permission.setCheckedKeys(i.split(","))}))},handleDelete:function(e,t){var i=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a["b"])({id:t.id}).then((function(e){e&&(i.$message({type:"success",message:e.message}),i.getList())})).catch((function(e){i.$throw(e)}))})).catch((function(){i.$message({type:"info",message:"已取消操作!"})}))},getList:function(){var e=this;Object(a["c"])().then((function(t){for(var i=0;i<t.data.rows.length;i++)t.data.rows[i].status?t.data.rows[i].status="启用":t.data.rows[i].status="禁用";e.tableData=t.data.rows})).catch((function(t){e.$throw(t)}))},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)}}},n=l,r=(i("af17"),i("2877")),c=Object(r["a"])(n,o,s,!1,null,"7669bd09",null);t["default"]=c.exports},af17:function(e,t,i){"use strict";i("32f5")}}]);