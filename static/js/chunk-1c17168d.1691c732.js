(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c17168d"],{2658:function(e,t,a){"use strict";a("fca0")},a48b:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addArticle"},[a("el-form",{ref:"article",attrs:{inline:!0,model:e.article,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"文章标题"}},[a("el-input",{staticClass:"title",attrs:{placeholder:"文章标题"},model:{value:e.article.title,callback:function(t){e.$set(e.article,"title",t)},expression:"article.title"}})],1),a("el-form-item",{attrs:{label:"引言"}},[a("el-input",{staticClass:"inline-input",attrs:{placeholder:"请输入内容"},model:{value:e.article.describe,callback:function(t){e.$set(e.article,"describe",t)},expression:"article.describe"}})],1),a("el-form-item",{attrs:{label:"标签"}},[a("ArticleLabel",{on:{translabel:e.translabel}})],1),a("el-form-item",{attrs:{label:"是否置顶"}},[a("el-switch",{model:{value:e.article.top,callback:function(t){e.$set(e.article,"top",t)},expression:"article.top"}})],1),a("el-form-item",[a("el-button",{staticClass:"subBtn",attrs:{type:"primary"},on:{click:e.submitArticle}},[e._v("发布")])],1),a("el-form-item",{attrs:{label:"缩略图上传","label-width":"95px"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://mboke.top/api/qiniu/upload","show-file-list":!1,multiple:!1,"on-success":e.handlethumbnailSuccess,"on-progress":e.handlethumbnailLoading,"before-upload":e.beforethumbnailUpload}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:e.thumbnailProcess}}),a("p",[e._v("只能上传jpg/png文件，且不超过2MB!")])],1),e.article.thumbnail?a("img",{staticClass:"avatar",attrs:{src:e.article.thumbnail}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"banner图上传","label-width":"110px"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://mboke.top/api/qiniu/upload",multiple:!1,"show-file-list":!1,"on-success":e.handleBannerSuccess,"before-upload":e.beforeBannerUpload,disabled:""}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("此图功能未开发，暂可不必上传!")]),e.article.banner?a("img",{staticClass:"avatar",attrs:{src:e.article.banner}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),a("WangEditor",{attrs:{value:e.article.value,"is-clear":e.isClear},on:{change:e.change},model:{value:e.article.content_html,callback:function(t){e.$set(e.article,"content_html",t)},expression:"article.content_html"}})],1)},i=[],r=a("53ca"),n=(a("b64b"),a("e1d1")),c=a("70fc"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-cascader",{ref:"label",attrs:{placeholder:"文章标签",options:e.options,"show-all-levels":!1,props:{multiple:!0,checkStrictly:!0,emitPath:!1},clearable:""},on:{change:e.handleChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)},o=[],u=a("1da1"),d=(a("159b"),a("96cf"),a("ed1d")),m=a("bc3d"),b={data:function(){return{options:[],value:[]}},created:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var a,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])();case 2:return a=t.sent,t.next=5,Object(m["a"])();case 5:l=t.sent,e.handleOptions(a,l);case 7:case"end":return t.stop()}}),t)})))()},methods:{handleChange:function(){this.$emit("translabel",this.value)},handleOptions:function(e,t){var a=this;e.data.forEach((function(e){a.options.push({value:e.academic_name,label:e.academic_name,id:e.id,children:[],disabled:!0})})),this.options.forEach((function(e){var a=e.id;t.data.forEach((function(t){a==t.field_id&&e.children.push({value:t.label_name,label:t.label_name})}))}))}}},p=b,h=a("2877"),f=Object(h["a"])(p,s,o,!1,null,null,null),g=f.exports,v={name:"AddArticle",components:{WangEditor:c["a"],ArticleLabel:g},data:function(){return{article:{id:"",title:"",describe:"",article_label:"",top:!1,content_html:"",thumbnail:"",banner:"",value:""},isClear:!1,thumbnailProcess:0}},mounted:function(){var e=this;if(Object.keys(this.$route.query).length>0){var t=this.$route.query.articleId;Object(n["f"])({id:t}).then((function(t){for(var a in e.article)e.article[a]=t[a];e.article.value=t.content_html}))}},methods:{translabel:function(e){this.article.article_label=e},change:function(e){this.article.content_html=e},handlethumbnailSuccess:function(e,t){this.article.thumbnail=e.data.url},handlethumbnailLoading:function(e,t){this.thumbnailProcess=e.percent},beforethumbnailUpload:function(e){this.thumbnailProcess=0;var t="image/jpeg"===e.type,a="image/png"===e.type,l=e.size/1024/1024<2;return t||a||this.$message.error("上传文章缩略图只能是 JPG/PNG 格式!"),l||this.$message.error("上传文章缩略图大小不能超过 2MB!"),l&&t||a&&l},handleBannerSuccess:function(e,t){this.article.banner=e.data.url},beforeBannerUpload:function(e){var t="image/jpeg"===e.type,a="image/png"===e.type,l=e.size/1024/1024<5;return t||a||this.$message.error("上传banner只能是 JPG/PNG 格式!"),l||this.$message.error("上传banner图片大小不能超过 5MB!"),l&&t||a&&l},submitArticle:function(){var e=this;"object"!==Object(r["a"])(this.article.article_label)?this.$message({message:"文章标签必填!",type:"error"}):Object(n["a"])(this.article).then((function(t){t&&e.$message({type:"success",message:t.message}),e.$router.push({name:"文章列表"})})).catch((function(t){e.$throw(t)}))}}},A=v,_=(a("2658"),Object(h["a"])(A,l,i,!1,null,"30179d9f",null));t["default"]=_.exports},bc3d:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var l=a("b775"),i={addArticleLabel:"/articlelabel/addArticleLabel",getArticleLabel:"/articlelabel/getArticleLabel"};function r(e){return Object(l["a"])({url:i.getArticleLabel,method:"get",params:e})}},e1d1:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return u}));var l=a("b775"),i={addArticle:"/article/addArticle",articleList:"/article/articleList",getArticle:"/article/getArticle",delArticle:"/article/delArticle",uploadImg:"/editor/uploadImg",commentList:"/comment/commentList",delComment:"/comment/delComment"};function r(e){return Object(l["a"])({url:i.addArticle,method:"post",data:e})}function n(e){return Object(l["a"])({url:i.articleList,method:"get",params:e})}function c(e){return Object(l["a"])({url:i.getArticle,method:"post",data:e})}function s(e){return Object(l["a"])({url:i.delArticle,method:"post",data:e})}function o(e){return Object(l["a"])({url:i.commentList,method:"get",params:e})}function u(e){return Object(l["a"])({url:i.delComment,method:"post",data:e})}},ed1d:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var l=a("b775"),i={addAcademicField:"/academic/addAcademicField",getAcademicField:"/academic/getAcademicField"};function r(e){return Object(l["a"])({url:i.getAcademicField,method:"get",params:e})}},fca0:function(e,t,a){}}]);