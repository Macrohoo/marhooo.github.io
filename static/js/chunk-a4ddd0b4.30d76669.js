(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a4ddd0b4"],{2638:function(e,t,a){"use strict";function n(){return n=Object.assign||function(e){for(var t,a=1;a<arguments.length;a++)for(var n in t=arguments[a],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},n.apply(this,arguments)}var r=["attrs","props","domProps"],s=["class","style","directives"],i=["on","nativeOn"],l=function(e){return e.reduce((function(e,t){for(var a in t)if(e[a])if(-1!==r.indexOf(a))e[a]=n({},e[a],t[a]);else if(-1!==s.indexOf(a)){var l=e[a]instanceof Array?e[a]:[e[a]],o=t[a]instanceof Array?t[a]:[t[a]];e[a]=l.concat(o)}else if(-1!==i.indexOf(a))for(var u in t[a])if(e[a][u]){var d=e[a][u]instanceof Array?e[a][u]:[e[a][u]],p=t[a][u]instanceof Array?t[a][u]:[t[a][u]];e[a][u]=d.concat(p)}else e[a][u]=t[a][u];else if("hook"==a)for(var h in t[a])e[a][h]=e[a][h]?c(e[a][h],t[a][h]):t[a][h];else e[a]=t[a];else e[a]=t[a];return e}),{})},c=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}};e.exports=l},"26a6":function(e,t,a){},4016:function(e,t,a){},"5bfe":function(e,t,a){"use strict";a.r(t);var n,r,s,i,l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gallery"},[a("el-tabs",{staticClass:"yael-tabs",attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"图片视频",name:"image"}},[a("pvSelect")],1),a("el-tab-pane",{attrs:{label:"其他素材",name:"video"}},[a("otherSelect")],1)],1)],1)},c=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gallery-contain flex justify-around align-center"},[a("el-card",{staticClass:"left"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("素材分组")]),a("span",{staticStyle:{float:"right",padding:"0"}},[e._v("操作")])]),a("div",{staticClass:"left-groups"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{staticClass:"left-groups-row",class:{current:-1===e.currentIndex},attrs:{"data-index":"-1"},on:{click:function(t){return t.target!==t.currentTarget?null:e.checkGroupAll(t)}}},[a("div",{staticClass:"flex align-center"},[a("svg-icon",{staticStyle:{width:"20px",height:"20px"},attrs:{"icon-class":"wenjian"}}),a("span",[e._v("全部")])],1)]),e._l(this.$store.getters.groups,(function(t,n){return a("div",{key:n},[a("div",{staticClass:"left-groups-row",class:{current:n===e.currentIndex},attrs:{"data-id":t.id},on:{click:function(t){return t.target!==t.currentTarget?null:e.checkGroup(n,t)}}},[a("div",{staticClass:"flex align-center"},[a("svg-icon",{staticStyle:{width:"20px",height:"20px"},attrs:{"icon-class":"wenjian"}}),a("span",[e._v(e._s(t.name))])],1),a("div",{staticClass:"flex align-center justify-between",staticStyle:{width:"78px"}},[a("OMDialog",{attrs:{id:t.id,title:"修改素材分组",placeholder:t.name,parent_id:t.parent_id},on:{confirm:e.handlePutGroup}},[a("el-button",{attrs:{type:"text"}},[e._v("编辑")])],1),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.cancelVisible,callback:function(a){e.$set(t,"cancelVisible",a)},expression:"item.cancelVisible"}},[a("p",[e._v("警告:确定删除素材分组?")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.cancelVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(){return e.handleDeleteGroup(t)}}},[e._v("确定")])],1),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)])])}))],2)],1),a("OMDialog",{staticClass:"flex align-center justify-center",staticStyle:{"margin-top":"12px"},attrs:{title:"新建素材分组"},on:{confirm:e.handlePostGroup}},[a("el-button",{staticClass:"yael-button",attrs:{size:"small"}},[e._v("新建分组")])],1)],1),a("div",{staticClass:"right flex flex-direction"},[a("el-pagination",{staticClass:"pageClass",attrs:{"page-size":10,layout:"prev, pager, next, jumper",total:this.$store.getters.containPagesCount>0?this.$store.getters.containPagesCount:10,background:""},on:{"current-change":e.handleCurrentChange}}),a("div",{staticClass:"right-tool flex flex-shrink-0 justify-start align-center"},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.repeatVisible,callback:function(t){e.repeatVisible=t},expression:"repeatVisible"}},[a("p",[e._v("警告:确定删除?")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.repeatVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(){return e.handleDeleteIn({gp:e.selectFiles,ml:e.selectMaterials})}}},[e._v("确定")])],1),a("el-button",{staticClass:"yael-button",attrs:{slot:"reference",size:"small",disabled:e.selectMaterials.length>0&&e.selectFiles.length>0||0===e.selectFiles.length&&0===e.selectMaterials.length||e.selectMaterials.length>1},slot:"reference"},[e._v("删除")])],1),a("OMCascader",{staticStyle:{margin:"0px 10px"},attrs:{options:this.$store.getters.cascaderGroups,disabled:e.selectMaterials.length>0&&e.selectFiles.length>0||0===e.selectFiles.length&&0===e.selectMaterials.length},on:{confirm:function(t){return e.moveGroup(t,{gp:e.selectFiles,ml:e.selectMaterials})}}},[a("el-button",{staticClass:"yael-button",attrs:{size:"small",disabled:e.selectMaterials.length>0&&e.selectFiles.length>0||0===e.selectFiles.length&&0===e.selectMaterials.length}},[e._v("移动至")])],1),a("OMDialog",{attrs:{id:e.selectFiles.length>0?e.selectFiles[0].id:"",title:"重命名分组",placeholder:e.selectFiles.length>0?e.selectFiles[0].name:"",parent_id:e.selectFiles.length>0?e.selectFiles[0].parent_id:"",disabled:e.selectMaterials.length>0||1!==e.selectFiles.length},on:{confirm:e.handlePutGroup}},[a("el-button",{staticClass:"yael-button",attrs:{size:"small",disabled:e.selectMaterials.length>0||1!==e.selectFiles.length}},[e._v("重命名")])],1),a("OMDialog",{staticStyle:{margin:"0px 10px"},attrs:{title:"新建子分组",parent_id:e.parentIdNeeded},on:{confirm:e.handlePostGroup}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!==e.currentIndex,expression:"currentIndex !== -1"}],staticClass:"yael-button",attrs:{size:"small"}},[e._v("新建子分组")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!==e.currentIndex,expression:"currentIndex !== -1"},{name:"popup",rawName:"v-popup.uploadPanel",value:e.fields,expression:"fields",modifiers:{uploadPanel:!0}}],staticClass:"yael-button",attrs:{id:"btn_upload",size:"small",module:"gallery",title:"素材上传面板",hide_cancel:"",sure_btn:"关闭"}},[e._v("上传面板")])],1),(e.currentIndex,a("div",{staticClass:"right-contain flex flex-grow-1 flex-direction justify-between"},[a("div",{staticClass:"right-contain-flie flex justify-start align-center"},e._l(this.$store.getters.containGroups,(function(t,n){return a("div",{key:n},[a("ya-checkbox",{attrs:{options:t,"select-data":e.selectFiles},on:{selectX:function(t){return e.selectFiles=t}},nativeOn:{"!dblclick":function(a){return e.handleDblclick(t.id,a)}}})],1)})),0),a("div",{staticClass:"right-contain-pv flex flex-wrap"},e._l(this.$store.getters.containMaterials,(function(t,n){return a("div",{key:n},[a("ya-checkbox",{attrs:{options:t,"select-data":e.selectMaterials,"link-src":"1"===t.type?t.url:t.thumbnail,"src-width":64,"src-height":64,width:104,height:104},on:{selectX:function(t){return e.selectMaterials=t}}})],1)})),0)]))],1)],1)},u=[],d=a("1da1"),p=a("5530"),h=(a("96cf"),a("a9e3"),a("159b"),a("d3b7"),a("25f0"),a("b0c0"),a("2638")),g=a.n(h),f={props:{title:{type:String,default:"分组"},placeholder:{type:String,default:""},max:{type:Number,default:8},disabled:{type:Boolean,default:!1},parent_id:{type:[Number,String]},id:{type:[Number,String]}},data:function(){return{dialogVisible:!1,inputData:""}},methods:{handleClose:function(){this.dialogVisible=!1},handleConfirm:function(){this.parent_id?this.$emit("confirm",{name:this.inputData,parent_id:this.parent_id,id:this.id}):this.$emit("confirm",{name:this.inputData,id:this.id}),this.handleClose(),this.inputData=""},handleOpen:function(){this.disabled||(this.dialogVisible=!0)}},render:function(e){var t=this,a=this.dialogVisible,n=this.handleOpen,r=this.handleClose,s=this.handleConfirm,i=this.placeholder,l=this.title,c={props:{title:l,width:"360px",visible:a,top:"30vh"}};return e("div",g()([{},{on:{"!click":n}},{class:"yael-dialog"}]),[this.$slots.default,e("el-dialog",g()([{on:{close:r}},c]),[e("el-input",{attrs:{placeholder:i,maxlength:this.max,"show-word-limit":!0},style:"padding: 0 20px",model:{value:t.inputData,callback:function(e){t.inputData=e}}}),e("span",{slot:"footer",class:"dialog-footer"},[e("el-button",{on:{click:r},attrs:{size:"small"}},["取 消"]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:s}},["确 定"])])])])}},m=f,b=a("2877"),v=Object(b["a"])(m,n,r,!1,null,null,null),x=v.exports,y=(a("fb6a"),{props:{options:{type:[Array,Object]},title:{type:String,default:"移动至"},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"移动至"}},data:function(){return{dialogVisible:!1,moveGroup_id:[]}},methods:{handleClose:function(){this.dialogVisible=!1},handleOpen:function(){this.disabled||(this.dialogVisible=!0)},handleConfirm:function(){this.$emit("confirm",this.moveGroup_id),this.handleClose(),this.moveGroup_id=[],this.$refs.cascader.clearCheckedNodes(),this.$refs.cascader.activePath=[]},handleChange:function(e){this.moveGroup_id=e.slice(-1),console.log(this.moveGroup_id)}},render:function(e){var t=this.dialogVisible,a=this.handleOpen,n=this.handleClose,r=this.handleConfirm,s=this.placeholder,i=this.title,l=this.options,c={props:{title:i,width:"660px",visible:t,top:"30vh"}},o={props:{options:l,props:{checkStrictly:!0},placeholder:s},ref:"cascader"};return e("div",{class:"yael-dialog",on:Object(p["a"])({},{"!click":a})},[this.$slots.default,e("el-dialog",g()([{on:{close:n}},c]),[e("el-cascader-panel",g()([{},o,{class:"yael-cascader",on:{change:this.handleChange}}])),e("span",{slot:"footer",class:"dialog-footer"},[e("el-button",{on:{click:n},attrs:{size:"small"}},["取 消"]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:r}},["确 定"])])])])}}),w=y,k=Object(b["a"])(w,s,i,!1,null,"f0a0bd3e",null),C=k.exports,_=a("2f62"),O=a("5f87"),$={inject:["reload"],components:{OMDialog:x,OMCascader:C},data:function(){return{myHeaders:{Authorization:"Bearer ".concat(Object(O["a"])())},parentIdNeeded:-1,repeatVisible:!1,currentIndex:Number,selectFiles:[],selectMaterials:[],fields:{}}},watch:{parentIdNeeded:{handler:function(e){this.fields={group_id:"".concat(e)}}}},methods:Object(p["a"])(Object(p["a"])(Object(p["a"])({},Object(_["b"])({handleGroups:"gallery/handleGroups",handleMaterials:"gallery/handleMaterials",handleSingleGroups:"gallery/handleSingleGroups",createMaterials:"gallery/createMaterials"})),Object(_["d"])({resetContainGroups:"gallery/SET_RESETCONTAINGROUPS",resetContainMaterials:"gallery/SET_RESETCONTAINMATERIALS"})),{},{moveGroup:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){var r,s,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,console.log(e),console.log(t),!(t.gp.length>0)){n.next=11;break}return s=[],a.selectFiles.forEach((function(e){s.push(e.id)})),n.next=8,a.$yian.gallery("put",{id:s.toString()},{include:"group"},{behavior:"batch"},{parent_id:e[0]});case 8:r=n.sent,n.next=16;break;case 11:return i=[],a.selectMaterials.forEach((function(e){i.push(e.id)})),n.next=15,a.$yian.gallery("put",{id:i.toString()},{include:"material"},{behavior:"batch"},{group_id:e[0]});case 15:r=n.sent;case 16:r&&(a.$message({type:"success",message:r.message}),a.reload()),n.next=22;break;case 19:n.prev=19,n.t0=n["catch"](0),a.$throw(n.t0);case 22:case"end":return n.stop()}}),n,null,[[0,19]])})))()},handleDblclick:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.parentIdNeeded=e,t.next=3,a.handleSingleGroups({id:e,page:1,size:10});case 3:a.selectFiles=[],a.selectMaterials=[];case 5:case"end":return t.stop()}}),t)})))()},checkGroup:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.currentIndex=e,a.parentIdNeeded=t.currentTarget.dataset.id,n.next=4,a.handleSingleGroups({id:t.currentTarget.dataset.id,page:1,size:10});case 4:a.selectFiles=[],a.selectMaterials=[];case 6:case"end":return n.stop()}}),n)})))()},checkGroupAll:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.currentIndex=parseInt(e.currentTarget.dataset.index),a.next=3,t.createMaterials({page:1,size:10});case 3:t.resetContainGroups(t.$store.getters.groups),t.resetContainMaterials(t.$store.getters.materials),t.parentIdNeeded=-1,t.selectFiles=[],t.selectMaterials=[];case 8:case"end":return a.stop()}}),a)})))()},handlePostGroup:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$yian.gallery("post",{include:"group"},{name:e.name,parent_id:parseInt(e.parent_id)});case 3:n=a.sent,n&&(t.$message({type:"success",message:n.message}),t.reload()),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$throw(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},handlePutGroup:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$yian.gallery("put",{id:"".concat(e.id)},{include:"group"},{name:e.name,parent_id:parseInt(e.parent_id)});case 3:n=a.sent,n&&(t.$message({type:"success",message:n.message}),t.reload()),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$throw(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},handleDeleteGroup:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$yian.gallery("delete",{id:"".concat(e.id)},{include:"group"});case 3:if(n=a.sent,!n){a.next=9;break}return t.$message({type:"success",message:n.message}),e.cancelVisible=!1,a.next=9,t.handleGroups();case 9:a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),t.$throw(a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()},handleDeleteIn:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,r,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!(e.gp.length>0)){a.next=9;break}return r=[],t.selectFiles.forEach((function(e){r.push(e.id)})),a.next=6,t.$yian.gallery("delete",{id:r.toString()},{include:"group"},{behavior:"batch"});case 6:n=a.sent,a.next=19;break;case 9:if(s=[],i=[],t.selectMaterials.forEach((function(e){s.push(e.id),i.push(e.url)})),!(s.length>1)){a.next=16;break}t.$message({type:"error",message:"暂无法支持批量删除素材，请逐一删除!"}),a.next=19;break;case 16:return a.next=18,t.$yian.gallery("delete",{id:s.toString()},{include:"material"},{url:i.toString()});case 18:n=a.sent;case 19:n&&(t.$message({type:"success",message:n.message}),t.repeatVisible=!1,t.reload()),a.next=25;break;case 22:a.prev=22,a.t0=a["catch"](0),t.$throw(a.t0);case 25:case"end":return a.stop()}}),a,null,[[0,22]])})))()},handleCurrentChange:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log(e),-1!=t.parentIdNeeded){a.next=6;break}return a.next=4,t.handleMaterials({page:e,size:10});case 4:a.next=8;break;case 6:return a.next=8,t.handleSingleGroups({id:t.parentIdNeeded,page:e,size:10});case 8:case"end":return a.stop()}}),a)})))()},handlethumbnailSuccess:function(e,t){console.log(e.data.url)},beforethumbnailUpload:function(e){var t="image/jpeg"===e.type,a="image/png"===e.type,n=e.size/1024/1024<2;return t||a||this.$message.error("上传文章缩略图只能是 JPG/PNG 格式!"),n||this.$message.error("上传文章缩略图大小不能超过 2MB!"),n&&t||a&&n}}),created:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.handleGroups();case 3:return t.next=5,e.createMaterials({page:1,size:10});case 5:e.currentIndex=-1,e.resetContainGroups(e.$store.getters.groups),e.resetContainMaterials(e.$store.getters.materials),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.$throw(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}},M=$,S=(a("a770"),Object(b["a"])(M,o,u,!1,null,"0e46226c",null)),j=S.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gallery-contain"})},I=[],N={},F=N,R=(a("bd88"),Object(b["a"])(F,G,I,!1,null,"eea00284",null)),z=R.exports,V={components:{pvSelect:j,otherSelect:z},data:function(){return{activeName:"image"}}},D=V,P=(a("dd11"),Object(b["a"])(D,l,c,!1,null,"323a87ee",null));t["default"]=P.exports},a770:function(e,t,a){"use strict";a("4016")},ab49:function(e,t,a){},bd88:function(e,t,a){"use strict";a("26a6")},dd11:function(e,t,a){"use strict";a("ab49")}}]);