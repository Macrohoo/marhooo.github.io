(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-254fb336"],{2017:function(e,s,r){"use strict";r("cafe")},"2a3c":function(e,s,r){},3657:function(e,s,r){"use strict";r("2a3c")},"62bc":function(e,s,r){},"9eb7":function(e,s,r){"use strict";r("62bc")},"9ed6":function(e,s,r){"use strict";r.r(s);var t=function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("div",{staticStyle:{height:"100%"}},[r("div",{staticClass:"login-container"},[r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[r("div",{staticClass:"title-container"},[r("h3",{staticClass:"title"},[e._v("MBOKE[CMS]")])]),r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"user"}})],1),r("el-input",{ref:"loginuser",attrs:{placeholder:"用户名/手机号码",name:"loginuser",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.loginuser,callback:function(s){e.$set(e.loginForm,"loginuser",s)},expression:"loginForm.loginuser"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),r("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"Password",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.handleLogin(s)}},model:{value:e.loginForm.password,callback:function(s){e.$set(e.loginForm,"password",s)},expression:"loginForm.password"}}),r("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),r("el-button",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{loading:e.loading,type:"primary"},on:{click:e.handleLogin}},[e._v("登录")]),r("el-button",{staticStyle:{width:"100%",margin:"10px 0px"},attrs:{type:"success"},on:{click:e.register}},[e._v("注册用户")]),r("div",{staticClass:"tips"},[r("span",{staticStyle:{"margin-right":"20px"}},[e._v("注意：已登过小程序的用户可用手机号码登录，默认密码为手机号码!")]),r("p",[e._v(" 温馨提示：请及时更改你的密码及用户名！")])])],1)],1),e.dialogregisterVisible?r("RegisterUser",{attrs:{"dialog-visible":e.dialogregisterVisible},on:{successCallback:e.successCallback}}):e._e()],1)},o=[],i=function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("el-dialog",{attrs:{title:"注册用户",width:"600px",visible:e.visible,"destroy-on-close":""},on:{close:e.closeCallback}},[r("el-form",{ref:"registerForm",staticClass:"demo-ruleForm",attrs:{model:e.registerForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"角色"}},[r("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.registerForm.role_id,callback:function(s){e.$set(e.registerForm,"role_id",s)},expression:"registerForm.role_id"}},e._l(e.roleData,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:e.disabled}})})),1)],1),r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.registerForm.username,callback:function(s){e.$set(e.registerForm,"username",s)},expression:"registerForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.registerForm.password,callback:function(s){e.$set(e.registerForm,"password",s)},expression:"registerForm.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.registerForm.checkPass,callback:function(s){e.$set(e.registerForm,"checkPass",s)},expression:"registerForm.checkPass"}})],1),r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.registerForm.name,callback:function(s){e.$set(e.registerForm,"name",s)},expression:"registerForm.name"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile_phone"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.registerForm.mobile_phone,callback:function(s){e.$set(e.registerForm,"mobile_phone",s)},expression:"registerForm.mobile_phone"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.submitForm("registerForm")}}},[e._v("注 册")])],1)],1)],1)},a=[],l=(r("159b"),r("b0c0"),r("c1fe")),n=r("1779"),c={name:"RegisterUser",props:{dialogVisible:{type:Boolean,default:!1}},data:function(){var e=this,s=function(s,r,t){""===r?t(new Error("请输入密码")):(""!==e.registerForm.checkPass&&e.$refs.registerForm.validateField("checkPass"),t())},r=function(s,r,t){""===r?t(new Error("请再次输入密码")):r!==e.registerForm.password?t(new Error("两次输入密码不一致!")):t()};return{visible:this.dialogVisible,roleData:[],registerForm:{username:"",password:"",checkPass:"",role_id:"",name:"",mobile_phone:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:6,max:18,message:"长度在 6 到 18 个字符",trigger:"blur"}],password:[{required:!0,validator:s,trigger:"blur"},{min:6,max:18,message:"密码长度在 6 到 18 个字符",trigger:"blur"}],checkPass:[{required:!0,validator:r,trigger:"blur"},{min:6,max:18,message:"密码长度在 6 到 18 个字符",trigger:"blur"}],mobile_phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{min:11,max:11,message:"请准确输入手机号码格式",trigger:"blur"}]}}},created:function(){this.getTouristRoleId()},methods:{closeCallback:function(){this.$emit("successCallback")},submitForm:function(e){var s=this;this.$refs[e].validate((function(e){if(s.registerForm.role_id.length>0){if(!e)return s.$message({message:"请按规定格式输入信息！",type:"error"}),!1;Object(l["f"])(s.registerForm).then((function(e){console.log(e),e&&(s.$message({type:"success",message:e.message}),s.visible=!1)})).catch((function(e){s.$throw(e)}))}else s.$message({message:"请选择注册角色!",type:"error"})}))},getTouristRoleId:function(){var e=this;Object(n["c"])().then((function(s){var r=s.data.rows;r.forEach((function(s){"管理员"===s.name?(s.disabled=!0,e.roleData.push(s)):e.roleData.push(s)}))}))}}},u=c,m=(r("9eb7"),r("2877")),p=Object(m["a"])(u,i,a,!1,null,"34701375",null),d=p.exports,g={name:"Login",components:{RegisterUser:d},data:function(){var e=function(e,s,r){s.length<3?r(new Error("The password can not be less than 3 digits")):r()};return{loginForm:{loginuser:"",password:""},loginRules:{password:[{required:!0,trigger:"blur",validator:e}]},loading:!1,passwordType:"password",redirect:void 0,dialogregisterVisible:!1}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},methods:{showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(s){if(!s)return console.log("error submit!!"),!1;e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$router.push({path:e.redirect||"/"}),e.$message({showClose:!1,message:"登录成功!",type:"success"}),e.loading=!1})).catch((function(){e.loading=!1}))}))},register:function(){this.dialogregisterVisible=!0},successCallback:function(){this.dialogregisterVisible=!1}}},f=g,b=(r("2017"),r("3657"),Object(m["a"])(f,t,o,!1,null,"c7e31fd4",null));s["default"]=b.exports},cafe:function(e,s,r){}}]);